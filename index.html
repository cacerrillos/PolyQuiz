<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>PolyQuiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<script src="bower_components/skel/dist/skel.min.js"></script>
<script src="bower_components/skel/dist/skel-layout.min.js"></script>
<script>
skel.breakpoints({
	xlarge: "(max-width: 1680px)",
	large:  "(max-width: 1280px)",
	medium: "(max-width: 980px)",
	small:  "(max-width: 736px)",
	xsmall: "(max-width: 580px)",
	xxsmall: "(max-width: 480px)",
	xxxsmall: "(max-width: 360px)"
});
skel.layout({
	reset: "normalize",
	grid: {
		gutters: "40px"
	},
	containers: true,
	conditionals: true,
	breakpoints: {
		large: {
			containers: "95%"
		},
		medium: {
			containers: "95%",
			grid: {
				gutters: "30px"
			}
		},
		small: {
			containers: "95%",
			grid: {
				gutters: "20px"
			}
		},
		xsmall: {
			grid: {
				gutters: "10px"
			}
		},
		xxsmall: {
			grid: {
				gutters: "5px"
			}
		},
		xxxsmall: {
			containers: "100%"
		}
	}
});
</script>
<script src="bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
<script src="bower_components/page/page.js"></script>
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/autofill-event/src/autofill-event.js"></script>
<link rel="import" href="elements/polyquiz-app.html">

<style is="custom-style">
	body{
		font-family: Roboto;
	}
	:root {
		--dark-primary-color:       #1976D2;
		--default-primary-color:    #2196F3;
		--light-primary-color:      #BBDEFB;
		--text-primary-color:       #FFFFFF;
		--accent-color:             #8BC34A;
		--primary-background-color: #BBDEFB;
		--primary-text-color:       #212121;
		--secondary-text-color:     #727272;
		--disabled-text-color:      #BDBDBD;
		--divider-color:            #B6B6B6;
		
		
		/* Components */
		
		/* paper-drawer-panel */
		--drawer-menu-color:           #ffffff;
		--drawer-border-color:         1px solid #ccc;
		--drawer-toolbar-border-color: 1px solid rgba(0, 0, 0, 0.22);
		
		/* paper-menu */
		--paper-menu-background-color: #fff;
		--menu-link-color:             #111111;
		
		/* paper-input */
		/*
		--paper-input-container-color: rgba(0,0,0,0.75);
		--paper-input-container-focus-color: #2196F3;
		*/
		--paper-menu-selected-item: {
			color: #2196F3;
		}
	}
	paper-material {
		margin-top: 10px;
		margin-bottom: 10px;
		background-color: white;
	}
		
</style>
<script>
function PolyQuizPage(hash, friendlyName, icon, path, adminOnly) {
	this.hash = hash;
	this.friendlyName = friendlyName;
	this.icon = icon;
	this.path = path;
	this.adminOnly = adminOnly;
}
var polyQuizPages = [
	new PolyQuizPage("home", "Home", "icons:home", "/", false),
	new PolyQuizPage("takeaquiz", "Take A Quiz", "icons:content-paste", "/", false),
	new PolyQuizPage("admin", "Admin", "icons:settings", "/", false),
	new PolyQuizPage("sessions", "Sessions", "icons:settings", "/", true),
	new PolyQuizPage("quiz", "Quizzes", "icons:content-paste", "/", true)
];
function findPolyQuizPage(hash) {
	for(var k in polyQuizPages) {
		if(polyQuizPages.hasOwnProperty(k)) {
			var o = polyQuizPages[k];
			if(o.hash === hash) {
				return o;
			}
		}
	}
	console.log("Error!");
	return false;
}
</script>
</head>
<body>
	<polyquiz-app id="mainapp"></polyquiz-app>
</body>
</html>
<script>
var mainapp = document.querySelector("#mainapp");

page('/', function(ctx, next) {
	page.redirect('/home');
});
page('/home', handleSimplePage);

page('/takeaquiz', handleSimplePage);
page('/takeaquiz/:sessionid', handleTakeAQuiz);
page('/takeaquiz/:sessionid/:sessionkey', handleTakeAQuiz);

page('/admin', handleSimplePage);


page('/sessions', handleSimplePage);
page('/sessions/:sessionid', handleSimplePage);

page('/quiz', handleSimplePage);
page('/quiz/:quizid', handleQuizWithId);
page('/quiz/:quizid/edit', handleQuizEdit);

page('*', handleSimplePage);

page({hashbang: true });

function handleSimplePage(ctx, next) {
	mainapp.ctx = ctx;
	var path = ctx.path.split("/");
	var page = findPolyQuizPage(path[1]);
	if(page) {
		mainapp.page = page.hash;
	} else {
		//ddo404
		mainapp.notFound(ctx);
	}
}
function handleQuiz(ctx, next) {
	//page that shows all quizes / add new quiz
	mainapp.ctx = ctx;
	console.log("QUIZ");
	console.log(ctx);
}
function handleQuizWithId(ctx, next) {
	//page that shows overview of this quiz, stats?, maybe list the questions as read only?
	mainapp.ctx = ctx;
	mainapp.page = "quizedit";
	console.log("QUIZID");
	console.log(ctx);
}
function handleQuizEdit(ctx, next) {
	//page that lets you edit the quiz
	console.log("QUIZIDEDIT");
	console.log(ctx);
}

function handleTakeAQuiz(ctx, next) {
	mainapp.page = polyQuizPages.takeaquiz.hash;
	mainapp.ctx = ctx;
	page.redirect('/takeaquiz'); //Prevents the sessionid/key being saved in browser history
	next();
}
</script>