<!doctype html>
<dom-module id="quiz-question-answer-matching">
<link rel="import" href="admin-quiz-results/admin-quiz-results-delete-overlay.html">
	<link rel="import" href="admin-quiz-results/admin-quiz-results-row.html">
	<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
	<link rel="import" href="../bower_components/iron-icons/image-icons.html">
	<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
	<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
	<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
	<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
	<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
	<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
	<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
	<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
	<style is="custom-style">
		paper-material {
			background-color: white;
			margin-top: 5px;
			margin-bottom: 5px;
		}
	</style>
	<template>
		<paper-material>
			<div class="row">
				<div class="8u">
					<div id="answerTextContainer"></div>
				</div>
				<div class="4u">
					<paper-menu-button>
						<paper-button class="dropdown-trigger" id="current" style="font-weight: bold; color: #2196F3;">________</paper-button>
						<paper-menu class="dropdown-content" id="rightText" on-iron-select="onSelectedChange">
							<paper-item>________</paper-item>
							<template is="dom-repeat" items="[[right]]" as="thisright">
								<paper-item>[[thisright]]</paper-item>
							</template>
						</paper-menu>
					</paper-menu-button>
				</div>
			</div>
		</paper-material>
	</template>
	<script>
		Polymer({
			is: "quiz-question-answer-matching",
			properties: {
				right: Object,
				answerid: Number,
				answertext: String,
				questionparent: Object,
				selected: {
					type: Boolean,
					observer: "onSelectedChange"
				}
			},
			doClick: function() {
				//console.log(this.questionparent);
				this.questionparent.requestSelectAnswer(this.answerid);
			},
			doReset: function() {
				this.$.rightText.select('0');
			},
			_bleh: function(d){
				//console.log(d);
			},
			onSelectedChange: function(details) {
				this.$.current.innerHTML = details.detail.item.textContent;
			},
			gen: function() {
				this.$.rightText.select('0');
			},
			ready: function() {
				this.$.answerTextContainer.innerHTML = this.answertext;
				
			}
		});
	</script>
</dom-module>
<dom-module id="quiz-question-answer-textfield">
<link rel="import" href="admin-quiz-results/admin-quiz-results-delete-overlay.html">
	<link rel="import" href="admin-quiz-results/admin-quiz-results-row.html">
	<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
	<link rel="import" href="../bower_components/iron-icons/image-icons.html">
	<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
	<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
	<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
	<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
	<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
	<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
	<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
	<style is="custom-style">
		paper-material {
			background-color: white;
			margin-top: 5px;
			margin-bottom: 5px;
		}
	</style>
	<template>
		<paper-material>
			<div class="row">
				<div class="12u">
					<paper-textarea label="Response" id="response">{{answertext}}</paper-textarea>
				</div>
			</div>
		</paper-material>
	</template>
	<script>
		Polymer({
			is: "quiz-question-answer-textfield",
			properties: {
				answerid: Number,
				answertext: String,
				questionparent: Object,
				selected: {
					type: Boolean,
					observer: "onSelectedChange"
				}
			},
			doClick: function() {
				console.log(this.questionparent);
				this.questionparent.requestSelectAnswer(this.answerid);
			},
			doReset: function() {
				this.$.response.value = "";
				
			},
			onSelectedChange: function() {
				if(this.selected){
					this.$.answerMaterial.style.backgroundColor = "#BBDEFB";
				} else {
					this.$.answerMaterial.style.backgroundColor = "white";
				}
			},
			ready: function() {
				//this.$.answerTextContainer.innerHTML = this.answertext;
			}
		});
	</script>
</dom-module>
<dom-module id="quiz-question-answer-standard">
<link rel="import" href="admin-quiz-results/admin-quiz-results-delete-overlay.html">
	<link rel="import" href="admin-quiz-results/admin-quiz-results-row.html">
	<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
	<link rel="import" href="../bower_components/iron-icons/image-icons.html">
	<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
	<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
	<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
	<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
	<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
	<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
	<style is="custom-style">
		.notselected {
			background-color: white;
		}
		.selected {
			background-color: blue;
		}
		paper-material {
			background-color: white;
			margin-top: 5px;
			margin-bottom: 5px;
		}
	</style>
	<template>
		<paper-material id="answerMaterial" on-click="doClick">
			<div class="row">
				<div class="12u" id="answerTextContainer"></div>
			</div>
		</paper-material>
	</template>
	<script>
		Polymer({
			is: "quiz-question-answer-standard",
			properties: {
				answerid: Number,
				answertext: String,
				questionparent: Object,
				selected: {
					type: Boolean,
					observer: "onSelectedChange"
				}
			},
			doClick: function() {
				this.questionparent.requestSelectAnswer(this);
			},
			doReset: function() {
				this.selected = false;
			},
			onSelectedChange: function() {
				if(this.selected){
					this.$.answerMaterial.style.backgroundColor = "#BBDEFB";
				} else {
					this.$.answerMaterial.style.backgroundColor = "white";
				}
			},
			ready: function() {
				
				this.$.answerTextContainer.innerHTML = this.answertext;
			}
		});
	</script>
</dom-module>
<dom-module id="quiz-question">
	<link rel="import" href="admin-quiz-results/admin-quiz-results-delete-overlay.html">
	<link rel="import" href="admin-quiz-results/admin-quiz-results-row.html">
	<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
	<link rel="import" href="../bower_components/iron-icons/image-icons.html">
	<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
	<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
	<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
	<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
	<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
	<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
	<style is="custom-style">
		paper-material {
			background-color: white;
			margin-top: 5px;
			margin-bottom: 5px;
		}
	</style>
	<template>
		<paper-material>
			<div id="questiontext"></div>
			<div id="answers"></div>
			<input type="hidden" name="answer" value="[[selectedanswer]]">
			<paper-button raised on-click="doReset">Reset</paper-button>
		</paper-material>
	</template>
	<script>
		Polymer({
			is: "quiz-question",
			properties: {
				qobject: Object,
				selectedanswer: {
					type: String,
					value: "-1"
				},
				preview: {
					type: Boolean,
					value: false
				}
			},
			doReset: function() {
				this.selectedanswer = "-1";
				for(var x = 0; x < this.$.answers.childNodes.length; x++){
					this.$.answers.childNodes[x].doReset();
				}
			},
			setSelected: function(num) {
				this.selectedanswer = num;
				if(this.qobject.type != 1 && this.qobject.type != "1"){
					for(var x = 0; x < this.$.answers.childNodes.length; x++){
						console.log(this.$.answers.childNodes[x]);
						if(this.$.answers.childNodes[x].answerid == this.selectedanswer) {
							this.$.answers.childNodes[x].selected = true;
						} else {
							this.$.answers.childNodes[x].selected = false;
						}
						
					}
				} else {
					this.$.answers.firstChild.answertext = this.selectedanswer;
				}
				
			},
			requestSelectAnswer: function(details) {
				if(this.qobject.type != 1 && this.qobject.type != "1"){
					this.selectedanswer = details.answerid;
					for(var x = 0; x < this.$.answers.childNodes.length; x++){
						this.$.answers.childNodes[x].selected = false;
					}
					details.selected = true;
				} else {
					console.log("fromfreee");
				}
			},
			_transformData: function(data){
				var arr = $.map(data, function(el) { return el; })
				//console.log(arr);
				return arr;
			},
			ready: function() {
				console.log(this.qobject);
				this.$.questiontext.innerHTML = this.qobject.question;
				switch(this.qobject.type){
					case "0":
					case "4":
					case 0:
					case 4:
						var aa = this._transformData(this.qobject.answerArray);
						for(var y = 0; y < aa.length; y++){
							var thisAnswer = document.createElement("quiz-question-answer-standard");
							thisAnswer.answerid = y;
							if(this.qobject.type == "0" || this.qobject.type == 0){
								thisAnswer.answertext = aa[y];
							} else {
								thisAnswer.answertext = aa[y].answer;
							}
							
							thisAnswer.questionparent = this;
							thisAnswer.ready();
							this.$.answers.appendChild(thisAnswer);
						}
						break;
					case "1":
					case 1:
						var textfieldAnswer = document.createElement("quiz-question-answer-textfield");
						textfieldAnswer.questionparent = this;
						textfieldAnswer.ready();
						this.$.answers.appendChild(textfieldAnswer);
						break;
					case "2":
					case 2:
						var left = this.qobject.left;
						for(var y = 0; y < left.length; y++){
							var thisAnswer = document.createElement("quiz-question-answer-matching");
							thisAnswer.answerid = y;
							thisAnswer.answertext = left[y];
							thisAnswer.right = this.qobject.right;
							thisAnswer.questionparent = this;
							thisAnswer.ready();
							thisAnswer.gen();
							this.$.answers.appendChild(thisAnswer);
						}
						break;
				}
				if(this.selectedanswer != "-1" && this.selectedanswer != ""){
					this.setSelected(this.selectedanswer);
				}
			}
		});
	</script>
</dom-module>