<!doctype html>
<dom-module id="polyquiz-page-sessions">
	<link rel="import" href="../../bower_components/polymer/polymer.html">
	<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

	<style is="custom-style">
		paper-material {
			background-color: white;
		}
	</style>
	
	<template>
		<div class="container">
			<iron-pages id="pageSelector" attrForSelected="data-subpage" selected="[[sessionSubpage]]">
				<paper-material>
					<h3>Sessions</h3>
				</paper-material>
			</iron-pages>
		</div>
	</template>

	<script>
		Polymer({
			is: 'polyquiz-page-sessions',
			behaviors: [
				Polymer.NeonAnimatableBehavior
			],
			properties: {
				ctx: {
					type: Object,
					observer: "onContextChanged"
				},
				isAdmin: {
					type: Boolean,
					value: false
				},
				adminData: {
					type: Object
				}
			},
			onContextChanged: function(details) {
				return;
				if(details.params.subpage != null) {
					switch(details.params.subpage) {
						default:
							this.$.pageSelector.select(0);
					}
				} else {
					this.$.pageSelector.select(0);
				}
			},
			onAdminStatusChanged: function(e) {
				var details = e.detail;
				this.adminData = e.detail;
				this.isAdmin = details.admin;
				var parent = document.querySelector("#mainapp");
				this.loginOverlayCheck();
			},
			loginOverlayCheck: function(e) {
				console.log(e);
				console.log(this);
				var mainapp = document.querySelector("#mainapp");
				if(this.parentNode.selectedItem == this) {
					console.log("YESYESYES");
					if(this.adminData) {
						if(this.isAdmin) {
							mainapp.closeLoginOverlay();
							return;
						}
					}
					mainapp.openLoginOverlay();
				} else {
					console.log("nonononon");
				}
			},
			ready: function() {
				this.$.pageSelector.select(0);
				var mainapp = document.querySelector("#mainapp");
				mainapp.addEventListener('polyquiz-admin-status', this.onAdminStatusChanged.bind(this));

				var parentSelector = this.parentNode;

				parentSelector.addEventListener('iron-select', this.loginOverlayCheck.bind(this));
			}
		});
	</script>
</dom-module>